{% extends "base.html" %}
{% load staticfiles %}

{% block includes %}
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script type="text/javascript" src="{% static 'browse/js/jquery-2.1.3.min.js' %}"></script>
<script type="text/javascript" src="{% static 'browse/js/jquery.csv.min.js' %}"></script>
<script type="text/javascript" src="{% static 'browse/js/jquery.dataTables.min.js' %}"></script>
<script type="text/javascript" src="{% static 'browse/js/dataTables.bootstrap.js' %}"></script>
<script type="text/javascript" src="{% static 'browse/js/csv_to_html_table.js' %}"></script>
{% endblock %}

{% block content %}
<div class="container">
  <div class="page-header">
	  <h1>List of histone proteins in archaea</h1>
  </div>

    <div class="container-fluid">

      <div id='table-container'></div>

    </div><!-- /.container -->
</div>

<script type="text/javascript">
    function format_accession(accession){
        if (accession)
            return "<a href='https://www.ncbi.nlm.nih.gov/protein/" + accession + "'>" + accession + "</a>";
        else
            return accession;
    };
    function format_taxid(taxid){
        if (taxid)
            return "<a href='https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=" + taxid + "'>" + taxid + "</a>";
        else
            return taxid;
    };
    function format_pmid(pmids){
        if (pmids) {
            var pmids_list = pmids.replace("(?)", '').split(" ");
            var links_str = "<a href='https://www.ncbi.nlm.nih.gov/pubmed/" + pmids_list[0] + "'>" + pmids_list[0] + "</a>";
            if (pmids_list[0].search("^[0-9]+$") < 0)
                links_str = pmids_list[0];
            for (i = 1; i < pmids_list.length; i++) {
                if (pmids_list[i].search("^[0-9]+$") < 0)
                    links_str += "; " + pmids_list[i];
                else
                    links_str += "; <a href='https://www.ncbi.nlm.nih.gov/pubmed/" + pmids_list[i] + "'>" + pmids_list[i] + "</a>";
            }
            return links_str;
        }
        else
            return pmids;
    };
    CsvToHtmlTable.init({
        csv_path: "https://intbio.org/histonedb/CURATED_SET/curated_service/archaea_histones.csv",
        element: 'table-container',
        allow_download: true,
        csv_options: {separator: ',', delimiter: '"'},
        datatables_options: {"paging": false, "columnDefs": [{ targets: [0, 2, 3, 4, 5, 6, 7, 8], visible: true},
                                                            { targets: '_all', visible: false }]} ,
        custom_formatting: [[0, format_accession], [6, format_taxid], [8, format_pmid]]
    });
  </script>

<!-- <script type="text/javascript" src="https://intbio.org/hist_gene_prot/disp_func.js"></script> -->
{% endblock %}
